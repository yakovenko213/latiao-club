<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latiao Club | Luxury Admin & Bot</title>
    <style>
        /* –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤—Å—ñ —Å—Ç–∏–ª—ñ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ */
        :root {
            --primary: #FF6B00;
            --primary-light: #FF8533;
            --dark: #1A1A1A;
            --bg: #F8F9FA;
            --card-bg: rgba(255, 255, 255, 0.85);
            --border: rgba(0, 0, 0, 0.05);
            --text-main: #2D2D2D;
            --text-muted: #757575;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.04);
            --glass: blur(12px) saturate(180%);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        [data-theme="dark"] {
            --bg: #0F0F0F;
            --card-bg: rgba(30, 30, 30, 0.8);
            --border: rgba(255, 255, 255, 0.05);
            --text-main: #EDEDED;
            --text-muted: #A0A0A0;
            --shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', -apple-system, sans-serif; }
        body { background: var(--bg); color: var(--text-main); transition: var(--transition); min-height: 100vh; }
        .hidden { display: none !important; }
        .glass { background: var(--card-bg); backdrop-filter: var(--glass); border: 1px solid var(--border); border-radius: 20px; box-shadow: var(--shadow); }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .flex { display: flex; align-items: center; gap: 15px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .btn { padding: 12px 24px; border-radius: 12px; border: none; font-weight: 600; cursor: pointer; transition: var(--transition); text-align: center; font-size: 14px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: var(--dark); color: white; }
        .input-luxe { width: 100%; padding: 12px 16px; border-radius: 10px; border: 1px solid var(--border); background: var(--card-bg); color: var(--text-main); outline: none; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { text-align: left; padding: 15px; border-bottom: 1px solid var(--border); }
        .badge { padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 700; background: rgba(255,107,0,0.1); color: var(--primary); }
    </style>
</head>
<body data-theme="light">

    <div id="admin-login-screen" class="container" style="max-width: 400px; margin-top: 20vh;">
        <div class="glass" style="padding: 40px; text-align: center;">
            <h2 style="margin-bottom: 20px;">Latiao Admin</h2>
            <input type="password" id="admin-pass-input" class="input-luxe" placeholder="–ü–∞—Ä–æ–ª—å (latiao_admin)" style="margin-bottom: 15px;">
            <button class="btn btn-primary" style="width: 100%;" onclick="handleAdminLogin()">–£–≤—ñ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</button>
        </div>
    </div>

    <div id="admin-panel" class="hidden">
        <header class="container" style="display: flex; justify-content: space-between; align-items: center;">
            <div style="font-size: 20px; font-weight: 900;">LATIAO <span style="color:var(--primary)">ADMIN</span></div>
            <div class="flex">
                <button class="btn" onclick="toggleTheme()">üåì</button>
                <button class="btn btn-secondary" onclick="location.reload()">–í–∏–π—Ç–∏</button>
            </div>
        </header>

        <main class="container">
            <div class="flex" style="margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 10px;">
                <button class="btn" style="background:none; color:var(--text-main)" onclick="showTab('customers')">–ö–ª—ñ—î–Ω—Ç–∏</button>
                <button class="btn" style="background:none; color:var(--text-main)" onclick="showTab('telegram')">Telegram –ë–æ—Ç ü§ñ</button>
                <button class="btn" style="background:none; color:var(--text-main)" onclick="showTab('settings')">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</button>
            </div>

            <div id="tab-telegram" class="hidden">
                <div class="grid" style="grid-template-columns: 1fr 2fr;">
                    <div class="glass" style="padding: 25px; height: fit-content;">
                        <h3 style="margin-bottom: 15px;">–ö–µ—Ä—É–≤–∞–Ω–Ω—è –±–æ—Ç–æ–º</h3>
                        <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 20px;">
                            –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∏–∂—á–µ, —â–æ–± –∑–Ω–∞–π—Ç–∏ –Ω–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ –Ω–∞–ø–∏—Å–∞–ª–∏ –±–æ—Ç—É /start.
                        </p>
                        <button class="btn btn-primary" style="width: 100%;" onclick="syncTelegramSubscribers()">
                            üîÑ –û–Ω–æ–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤
                        </button>
                        <hr style="margin: 20px 0; opacity: 0.1;">
                        <button class="btn btn-secondary" style="width: 100%;" onclick="massInvite()">
                            üì¢ –†–æ–∑—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—è –≤—Å—ñ–º
                        </button>
                    </div>

                    <div class="glass" style="padding: 25px;">
                        <h3 style="margin-bottom: 15px;">–ü—ñ–¥–ø–∏—Å–Ω–∏–∫–∏ –±–æ—Ç–∞ (<span id="tg-count">0</span>)</h3>
                        <div style="overflow-x: auto;">
                            <table>
                                <thead>
                                    <tr>
                                        <th>User ID</th>
                                        <th>–ù—ñ–∫–Ω–µ–π–º</th>
                                        <th>–Ü–º'—è</th>
                                        <th>–î—ñ—è</th>
                                    </tr>
                                </thead>
                                <tbody id="tg-subscribers-list">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-customers">
                <div class="glass" style="padding: 25px;">
                    <h3>–ë–∞–∑–∞ –∫–ª—ñ—î–Ω—Ç—ñ–≤</h3>
                    <div id="client-list">
                        </div>
                </div>
            </div>

            <div id="tab-settings" class="hidden">
                <div class="glass" style="padding: 25px; max-width: 500px;">
                    <h3 style="margin-bottom: 20px;">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è API</h3>
                    <div style="margin-bottom: 15px;">
                        <label style="font-size: 12px; font-weight: 700;">TELEGRAM BOT TOKEN</label>
                        <input type="text" id="tg-token-input" class="input-luxe" placeholder="–í—Å—Ç–∞–≤—Ç–µ —Ç–æ–∫–µ–Ω...">
                    </div>
                    <button class="btn btn-primary" onclick="saveSettings()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- –°–¢–ê–ù ---
        let state = {
            tgSubscribers: JSON.parse(localStorage.getItem('lc_tg_subs')) || [],
            settings: JSON.parse(localStorage.getItem('lc_settings')) || { tgToken: '', theme: 'light' },
            users: JSON.parse(localStorage.getItem('lc_users')) || []
        };

        function save() {
            localStorage.setItem('lc_tg_subs', JSON.stringify(state.tgSubscribers));
            localStorage.setItem('lc_settings', JSON.stringify(state.settings));
        }

        // --- –ê–í–¢–û–†–ò–ó–ê–¶–Ü–Ø ---
        function handleAdminLogin() {
            const pass = document.getElementById('admin-pass-input').value;
            if (pass === 'latiao_admin') {
                document.getElementById('admin-login-screen').classList.add('hidden');
                document.getElementById('admin-panel').classList.remove('hidden');
                document.getElementById('tg-token-input').value = state.settings.tgToken;
                renderSubscribers();
            } else {
                alert('–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å');
            }
        }

        function showTab(tabId) {
            document.getElementById('tab-telegram').classList.add('hidden');
            document.getElementById('tab-customers').classList.add('hidden');
            document.getElementById('tab-settings').classList.add('hidden');
            document.getElementById('tab-' + tabId).classList.remove('hidden');
        }

        // --- TELEGRAM LOGIC ---

        // –§—É–Ω–∫—Ü—ñ—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∑ Telegram API
        async function syncTelegramSubscribers() {
            const token = state.settings.tgToken;
            if (!token) return alert('–°–ø–æ—á–∞—Ç–∫—É –≤–∫–∞–∂—ñ—Ç—å —Ç–æ–∫–µ–Ω —É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö!');

            try {
                // –û—Ç—Ä–∏–º—É—î–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–æ—Ç—É
                const response = await fetch(`https://api.telegram.org/bot${token}/getUpdates`);
                const data = await response.json();

                if (!data.ok) throw new Error(data.description);

                let newCount = 0;
                data.result.forEach(item => {
                    const chat = item.message ? item.message.chat : (item.my_chat_member ? item.my_chat_member.chat : null);
                    
                    if (chat && chat.id > 0) { // –¢—ñ–ª—å–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ñ —á–∞—Ç–∏
                        const exists = state.tgSubscribers.find(s => s.id === chat.id);
                        if (!exists) {
                            state.tgSubscribers.push({
                                id: chat.id,
                                username: chat.username || 'n/a',
                                first_name: chat.first_name || '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á',
                                date: new Date().toLocaleDateString()
                            });
                            newCount++;
                        }
                    }
                });

                save();
                renderSubscribers();
                alert(`–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –ó–Ω–∞–π–¥–µ–Ω–æ –Ω–æ–≤–∏—Ö: ${newCount}`);
            } catch (err) {
                alert('–ü–æ–º–∏–ª–∫–∞ API: ' + err.message);
            }
        }

        function renderSubscribers() {
            const list = document.getElementById('tg-subscribers-list');
            const countLabel = document.getElementById('tg-count');
            list.innerHTML = '';
            countLabel.innerText = state.tgSubscribers.length;

            state.tgSubscribers.forEach(sub => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><code>${sub.id}</code></td>
                    <td>@${sub.username}</td>
                    <td>${sub.first_name}</td>
                    <td>
                        <button class="btn" style="padding:5px 10px; font-size:11px; background:#27AE60; color:white;" 
                                onclick="sendInvite(${sub.id})">–ó–∞–ø—Ä–æ—Å–∏—Ç–∏</button>
                    </td>
                `;
                list.appendChild(tr);
            });
        }

        // –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—è
        async function sendInvite(chatId) {
            const token = state.settings.tgToken;
            const message = "üëã –ü—Ä–∏–≤—ñ—Ç! –ó–∞–ø—Ä–æ—à—É—î–º–æ —Ç–µ–±–µ –ø—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –¥–æ –Ω–∞—à–æ–≥–æ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–≥–æ Latiao Club! –ù–∞ —Ç–µ–±–µ –≤–∂–µ —á–µ–∫–∞—é—Ç—å –±–æ–Ω—É—Å–∏ —Ç–∞ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—ñ –¥–æ—Å—Ç–∞–≤–∫–∏. –ü—Ä–∏—î–¥–Ω—É–π—Å—è –∑–∞ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º: [–¢–í–û–Ñ –ü–û–°–ò–õ–ê–ù–ù–Ø]";

            try {
                const res = await fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ chat_id: chatId, text: message })
                });
                if (res.ok) alert('–ó–∞–ø—Ä–æ—à–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ —É—Å–ø—ñ—à–Ω–æ!');
                else alert('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—ñ.');
            } catch (e) {
                alert('–ü–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ.');
            }
        }

        // –ú–∞—Å–æ–≤–∞ —Ä–æ–∑—Å–∏–ª–∫–∞
        async function massInvite() {
            if (!confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—è –≤—Å—ñ–º (${state.tgSubscribers.length} —á–æ–ª.)?`)) return;
            
            for (let sub of state.tgSubscribers) {
                await sendInvite(sub.id);
                // –ù–µ–≤–µ–ª–∏–∫–∞ –∑–∞—Ç—Ä–∏–º–∫–∞, —â–æ–± Telegram –Ω–µ –∑–∞–±–ª–æ–∫—É–≤–∞–≤ –∑–∞ —Å–ø–∞–º
                await new Promise(r => setTimeout(r, 200));
            }
            alert('–ú–∞—Å–æ–≤—É —Ä–æ–∑—Å–∏–ª–∫—É –∑–∞–≤–µ—Ä—à–µ–Ω–æ!');
        }

        function saveSettings() {
            state.settings.tgToken = document.getElementById('tg-token-input').value.trim();
            save();
            alert('–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ!');
        }

        function toggleTheme() {
            state.settings.theme = state.settings.theme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', state.settings.theme);
            save();
        }
    </script>
</body>
</html>
